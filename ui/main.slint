import { Button, VerticalBox, HorizontalBox, LineEdit, ScrollView } from "std-widgets.slint";

// 1. DEFINICE TLAƒå√çTKA (P≈ô√≠mo zde, abychom nemuseli importovat)
component MenuButton inherits Rectangle {
    in-out property<string> text;
    in-out property<bool> active;
    callback clicked;
    
    height: 45px;
    background: active ? #2CC985 : touch.has-hover ? #3d3d3d : #2e2e2e;
    border-radius: 6px;
    border-width: 1px;
    border-color: active ? #2CC985 : #3f3f3f;

    touch := TouchArea { clicked => { root.clicked(); } }

    HorizontalLayout {
        padding-left: 20px;
        Text {
            text: root.text;
            color: root.active ? #1A1A1A : white;
            vertical-alignment: center;
            font-size: 14px;
            font-weight: root.active ? 800 : 500;
        }
    }
}

// 2. HLAVN√ç OKNO
export component AppWindow inherits Window {
    // 1. Vytvo≈ô√≠me vlastnost, kam Rust po≈°le verzi
    in-out property <string> verze_aplikace: "0.0.0"; 

    // 2. Titulek se teƒè skl√°d√° dynamicky (spojen√≠ ≈ôetƒõzc≈Ø)
    title: "MRB Obchodn√≠k - v" + verze_aplikace;
    
    min-width: 900px; 
    min-height: 650px;
    background: #1A1A1A;

    // --- PROMƒöNN√â PRO PROPOJEN√ç S RUSTEM ---
    property <int> vybrana_stranka: 0; // 0=Home, 1=Import, 2=Settings
    property <int> settings_tab: 0;    // Z√°lo≈æky uvnit≈ô nastaven√≠
    
    in-out property <string> cesta_archiv: "";
    in-out property <string> cesta_vyroba: "";
    
    callback vybrat_archiv();
    callback vybrat_vyrobu();

    // --- ROZVR≈ΩEN√ç ---
    HorizontalLayout {
        padding: 0; spacing: 0;

// LEV√ù PANEL
        Rectangle {
            width: 280px;
            background: #212121;
            
            // ZMƒöNA: Pou≈æijeme VerticalLayout, kter√Ω vypln√≠ celou v√Ω≈°ku rodiƒçe
            VerticalLayout {
                padding: 25px; 
                spacing: 10px;
                alignment: stretch; // D≈Øle≈æit√©: prvky se roztahuj√≠

                // 1. VRCHN√ç ƒå√ÅST (Nadpis a Tlaƒç√≠tka)
                Text { 
                    text: "MRB Obchodn√≠k"; 
                    color: #2CC985; 
                    font-size: 20px; 
                    font-weight: 900; 
                    horizontal-alignment: center; 
                }
                
                Rectangle { height: 20px; } // Pevn√° mezera

                MenuButton { text: "üè†  Domovsk√° obrazovka"; active: vybrana_stranka == 0; clicked => { vybrana_stranka = 0; } }
                MenuButton { text: "üìÇ  Nov√Ω import"; active: vybrana_stranka == 1; clicked => { vybrana_stranka = 1; } }
                MenuButton { text: "‚öô  Nastaven√≠ syst√©mu"; active: vybrana_stranka == 2; clicked => { vybrana_stranka = 2; } }

                // 2. PRU≈ΩINA (To kouzlo)
                // Tento prvek m√° vertical-stretch: 1, co≈æ znamen√°:
                // "Vezmi ve≈°ker√© zb√Ωvaj√≠c√≠ m√≠sto a vypl≈à ho."
                Rectangle {
                    vertical-stretch: 1; 
                }

                // 3. SPODN√ç ƒå√ÅST (Verze)
                Text { 
                    // Tady se text verze p≈ôilep√≠ √∫plnƒõ dol≈Ø
                    text: "v" + root.verze_aplikace; 
                    color: #555; 
                    font-size: 11px;
                    horizontal-alignment: center; 
                }
            }
        }

        // B) PRAV√ù OBSAH
        Rectangle {
            background: #1A1A1A;
            
            // 1. DOMOVSK√Å STR√ÅNKA
            if vybrana_stranka == 0 : VerticalBox {
                alignment: center; spacing: 20px;
                Text { text: "üè†"; font-size: 60px; horizontal-alignment: center; }
                Text { text: "V√≠tejte v syst√©mu"; font-size: 30px; font-weight: 800; color: white; horizontal-alignment: center; }
            }

            // 2. NOV√ù IMPORT
            if vybrana_stranka == 1 : VerticalBox {
                alignment: center;
                Text { text: "üöß"; font-size: 60px; horizontal-alignment: center; }
                Text { text: "Sekce Import"; font-size: 24px; color: white; horizontal-alignment: center; }
            }

            // 3. NASTAVEN√ç (S tv√Ωmi 3 z√°lo≈ækami)
            if vybrana_stranka == 2 : VerticalBox {
                padding: 40px; spacing: 20px; alignment: start;
                
                Text { text: "Nastaven√≠ syst√©mu"; font-size: 30px; font-weight: 800; color: white; }

                // P≈ôep√≠naƒç z√°lo≈æek v nastaven√≠
                HorizontalBox {
                    height: 40px; spacing: 10px; padding: 0;
                    Button { text: "Cesty"; primary: settings_tab == 0; clicked => { settings_tab = 0; } }
                    Button { text: "Synchronizace"; primary: settings_tab == 1; clicked => { settings_tab = 1; } }
                    Button { text: "Spr√°vce dat"; primary: settings_tab == 2; clicked => { settings_tab = 2; } }
                }

                // Obsah: Cesty
                if settings_tab == 0 : VerticalBox {
                    spacing: 20px; padding: 0;
                    
                    VerticalBox {
                        spacing: 5px; padding: 0;
                        Text { text: "CESTA K ARCHIVU"; color: #888; font-size: 11px; font-weight: 700; }
                        HorizontalBox {
                            padding: 0;
                            LineEdit { text: cesta_archiv; placeholder-text: "Vyberte slo≈æku..."; height: 40px; }
                            Button { text: "Proch√°zet"; width: 100px; clicked => { root.vybrat_archiv(); } }
                        }
                    }

                    VerticalBox {
                        spacing: 5px; padding: 0;
                        Text { text: "CESTA PRO V√ùROBU"; color: #888; font-size: 11px; font-weight: 700; }
                        HorizontalBox {
                            padding: 0;
                            LineEdit { text: cesta_vyroba; placeholder-text: "Vyberte slo≈æku..."; height: 40px; }
                            Button { text: "Proch√°zet"; width: 100px; clicked => { root.vybrat_vyrobu(); } }
                        }
                    }
                    
                    Rectangle { height: 20px; }
                    Button { text: "ULO≈ΩIT KONFIGURACI"; height: 50px; primary: true; }
                }

                // Obsah: Sync
                if settings_tab == 1 : Text { text: "Zde bude synchronizace..."; color: gray; }
                
                // Obsah: Spr√°vce
                if settings_tab == 2 : Text { text: "Zde bude seznam firem..."; color: gray; }
            }
        }
    }
}