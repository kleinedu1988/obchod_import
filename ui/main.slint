import { Button, VerticalBox, HorizontalBox, LineEdit, ScrollView } from "std-widgets.slint";

component MenuButton inherits Rectangle {
    in-out property<string> text;
    in-out property<bool> active;
    callback clicked;
    height: 45px;
    background: active ? #2CC985 : touch.has-hover ? #3d3d3d : #2e2e2e;
    border-radius: 6px;
    touch := TouchArea { clicked => { root.clicked(); } }
    HorizontalLayout {
        padding-left: 20px;
        Text {
            text: root.text;
            color: root.active ? #1A1A1A : white;
            vertical-alignment: center;
            font-size: 14px;
        }
    }
}

export component AppWindow inherits Window {
    in-out property <string> verze_aplikace: "0.0.0";
    in-out property <string> cesta_archiv: "";
    in-out property <string> cesta_vyroba: "";
    property <int> vybrana_stranka: 2; 
    property <int> settings_tab: 0;

    callback vybrat_archiv();
    callback vybrat_vyrobu();
    callback ulozit_nastaveni();
    callback spustit_synchronizaci();

    title: "MRB Obchodn√≠k - v" + verze_aplikace;
    min-width: 900px; min-height: 650px;
    background: #1A1A1A;

    HorizontalLayout {
        // --- LEV√ù PANEL ---
        Rectangle {
            width: 280px; background: #212121;
            VerticalLayout {
                padding: 25px; spacing: 10px;
                Text { text: "MRB Obchodn√≠k"; color: #2CC985; font-size: 20px; font-weight: 900; horizontal-alignment: center; }
                Rectangle { height: 20px; }
                MenuButton { text: "üè†  Domovsk√° obrazovka"; active: vybrana_stranka == 0; clicked => { vybrana_stranka = 0; } }
                MenuButton { text: "üìÇ  Nov√Ω import"; active: vybrana_stranka == 1; clicked => { vybrana_stranka = 1; } }
                MenuButton { text: "‚öô  Nastaven√≠ syst√©mu"; active: vybrana_stranka == 2; clicked => { vybrana_stranka = 2; } }
                Rectangle { vertical-stretch: 1; }
                Text { text: "v" + root.verze_aplikace; color: #555; font-size: 11px; horizontal-alignment: center; }
            }
        }

        // --- PRAV√ù OBSAH ---
        VerticalLayout {
            padding: 40px;
            spacing: 20px;

            // 1. P≈òEP√çNAƒåE NASTAVEN√ç (zobraz√≠ se jen v sekci Nastaven√≠)
            if (vybrana_stranka == 2) : HorizontalLayout {
                height: 45px; spacing: 10px;
                Button { text: "Cesty"; primary: settings_tab == 0; clicked => { settings_tab = 0; } }
                Button { text: "Synchronizace"; primary: settings_tab == 1; clicked => { settings_tab = 1; } }
                Button { text: "Spr√°vce dat"; primary: settings_tab == 2; clicked => { settings_tab = 2; } }
            }

            // 2. DYNAMICK√ù OBSAH Z√ÅLO≈ΩEK
            // --- CESTY ---
            if (vybrana_stranka == 2 && settings_tab == 0) : VerticalLayout {
                vertical-stretch: 1;
                spacing: 20px;
                Text { text: "CESTA K ARCHIVU"; color: #888; font-size: 11px; font-weight: 700; }
                HorizontalLayout {
                    spacing: 10px; height: 40px;
                    LineEdit { text: cesta_archiv; } // Opraveno: vertical-alignment smaz√°no
                    Button { text: "Proch√°zet"; width: 100px; clicked => { root.vybrat_archiv(); } }
                }
                Text { text: "CESTA PRO V√ùROBU"; color: #888; font-size: 11px; font-weight: 700; }
                HorizontalLayout {
                    spacing: 10px; height: 40px;
                    LineEdit { text: cesta_vyroba; } // Opraveno: vertical-alignment smaz√°no
                    Button { text: "Proch√°zet"; width: 100px; clicked => { root.vybrat_vyrobu(); } }
                }
                
                Rectangle { vertical-stretch: 1; } // Pru≈æina vytlaƒç√≠ tlaƒç√≠tko dol≈Ø
                
                Button { 
                    text: "ULO≈ΩIT KONFIGURACI"; height: 50px; primary: true; 
                    clicked => { root.ulozit_nastaveni(); } 
                }
            }

            // --- SYNCHRONIZACE ---
            if (vybrana_stranka == 2 && settings_tab == 1) : VerticalLayout {
                vertical-stretch: 1;
                spacing: 25px;
                // alignment: start;  <-- TOTO JSME SMAZALI, ABY PRU≈ΩINA FUNGOVALA
                
                Text { 
                    text: "Synchronizace partner≈Ø"; 
                    font-size: 22px; font-weight: 700; color: white; 
                    horizontal-alignment: center; 
                }
                
                Rectangle {
                    border-color: #2CC985; border-width: 2px; border-radius: 10px;
                    height: 100px;
                    Text { 
                        text: "‚òë DATAB√ÅZE JE AKTU√ÅLN√ç"; 
                        color: #2CC985; font-size: 20px; font-weight: 800; 
                        horizontal-alignment: center; vertical-alignment: center; 
                    }
                }

                VerticalLayout {
                    spacing: 5px;
                    Text { text: "Posledn√≠ aktualizace probƒõhla:"; color: #888; font-size: 14px; horizontal-alignment: center; }
                    Text { text: "Dnes v 14:20"; color: white; font-size: 20px; font-weight: 600; horizontal-alignment: center; }
                }

                // TA NEJD≈ÆLE≈ΩITƒöJ≈†√ç ƒå√ÅST:
                Rectangle { vertical-stretch: 1; } // Teƒè u≈æ se tahle pru≈æina koneƒçnƒõ rozt√°hne!

                Button { 
                    text: "NAHR√ÅT EXCEL A SPUSTIT"; height: 50px; primary: true;
                    clicked => { root.spustit_synchronizaci(); }
                }
            }

            // --- OSTATN√ç STR√ÅNKY ---
            if (vybrana_stranka == 0) : VerticalLayout { vertical-stretch: 1; alignment: center; Text { text: "üè† Domovsk√° obrazovka"; font-size: 30px; horizontal-alignment: center; color: white; } }
            if (vybrana_stranka == 1) : VerticalLayout { vertical-stretch: 1; alignment: center; Text { text: "üìÇ Sekce Import"; font-size: 30px; horizontal-alignment: center; color: white; } }
            if (vybrana_stranka == 2 && settings_tab == 2) : VerticalLayout { vertical-stretch: 1; Text { text: "Zde bude spr√°vce dat..."; color: gray; } Rectangle { vertical-stretch: 1; } }
        }
    }
}